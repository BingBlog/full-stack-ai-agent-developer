# Agent 编排与工具调用

## 框架基础与选择

1. [频率:高][难度:易] 对比 LangChain、LangGraph、CrewAI 在流程建模上的核心差异。 提示：说明声明式、图结构、多 Agent 协同特点。
2. [频率:高][难度:易] LCEL 的执行模型如何提升可观测性与调试体验？ 提示：关注 Runnable、流式回调、step tracing。
3. [频率:高][难度:中] AutoGen 的 AgentGraph 与传统 Chain 架构相比解决了哪些问题？ 提示：多角色、并行任务、条件逻辑。
4. [频率:高][难度:中] 何时应该选择轻量级框架（如 OpenAI Functions）而不是复杂编排平台？ 提示：权衡业务复杂度与上线成本。
5. [频率:中][难度:中] 解释 LangSmith、OpenAI Observability 等工具在开发流程中的价值。 提示：覆盖日志、重放、性能监控。
6. [频率:中][难度:难] 面对企业合规要求时，框架选型需要考虑哪些扩展能力？ 提示：离线部署、权限隔离、自定义审计。
7. [频率:中][难度:难] 分享你整合多个 Agent 框架时的经验，如何管理依赖与版本？ 提示：模块化封装、接口抽象、回归测试。

## 工具集成与函数调用

1. [频率:高][难度:易] 设计自定义 Tool 时需要定义哪些字段与错误处理逻辑？ 提示：参数 schema、异常捕获、重试策略。
2. [频率:高][难度:易] 如何将 GraphQL/REST API 转换为 Agent 可调用的函数？ 提示：结合 OpenAPI、JSON schema 自动生成。
3. [频率:高][难度:中] 在工具链中添加数据库或检索工具时，你如何管理连接池与超时？ 提示：限制并发、断路器、重试退避。
4. [频率:高][难度:中] 函数调用结果如何结构化反馈给 LLM 以减少解析错误？ 提示：使用 JSON schema、明确字段名。
5. [频率:中][难度:中] 当外部服务不稳定时，你会如何设计 Tool 的降级与回退路径？ 提示：缓存结果、切换备用服务、人工介入。
6. [频率:中][难度:难] 工具执行是否需要权限校验？如何在 Agent 层实现最小权限控制？ 提示：token scope、签名校验、角色映射。
7. [频率:中][难度:难] 分享一次你将内部系统（如 CRM/工单）封装为 Agent 工具的经验。 提示：数据脱敏、请求审计、监控指标。

## 记忆管理与状态

1. [频率:高][难度:易] 短期记忆与长期记忆在 Agent 中如何划分，分别存放哪些信息？ 提示：当前上下文 vs 持久存档。
2. [频率:中][难度:易] 说明 ConversationBufferMemory、VectorStoreRetrieverMemory 的区别与适用场景。 提示：线性对话 vs 知识检索。
3. [频率:中][难度:中] 如何使用 Redis 或数据库实现多会话共享记忆？ 提示：设计键空间、TTL、序列化格式。
4. [频率:中][难度:中] 当记忆不断膨胀时，如何进行裁剪与摘要以控制成本？ 提示：基于回放评分、聚类、压缩。
5. [频率:低][难度:中] 在多 Agent 环境下，如何同步共享记忆并避免竞争条件？ 提示：消息总线、乐观锁序列、版本号。
6. [频率:低][难度:难] 描述你为 Agent 添加个性化或长期目标记忆的实践。 提示：持久存储、标签体系、上下文注入。
7. [频率:低][难度:难] 如何在记忆中记录工具调用历史并用于故障定位？ 提示：记录输入输出、状态码、时间戳。

## 多 Agent 协作策略

1. [频率:高][难度:中] 对比 ReAct、Plan-and-Execute、Tree-of-Thought 在多步骤任务中的表现。 提示：关注推理深度、控制开销。
2. [频率:中][难度:中] 解释 AutoGen GroupChat 的消息调度与结束条件。 提示：角色轮询、最大轮次、投票机制。
3. [频率:中][难度:难] 如何设计裁判/审阅 Agent，确保最终答案可控？ 提示：引入评价角色、评分阈值、反馈循环。
4. [频率:中][难度:难] 当多个 Agent 对同一任务理解不一致时，如何统一目标？ 提示：共识协议、目标摘要、管理员介入。
5. [频率:低][难度:难] 编排多 Agent 并行执行时，如何避免资源竞争或死锁？ 提示：任务队列、优先级、限流。
6. [频率:低][难度:难] 举例说明如何在 Agent 协作中引入人类参与（Human-in-the-loop）。 提示：人工确认节点、审批流程。
7. [频率:低][难度:难] 描述一次你为复杂业务设计角色体系的经历。 提示：角色职责、交互规则、权责边界。

## 可靠性与监控

1. [频率:高][难度:中] Agent 工作流中常见的失败类型有哪些？如何分类处理？ 提示：模型失败、工具异常、业务规则冲突。
2. [频率:中][难度:中] 如何设计重试与回退策略以提升成功率？ 提示：指数退避、备选工具、降级响应。
3. [频率:中][难度:难] 监控 Agent 运行时，你会重点跟踪哪些指标？ 提示：成功率、平均轮次、平均延迟、成本。
4. [频率:中][难度:难] 如何记录完整的消息轨迹以便问题排查？ 提示：structured logging、trace id、内容脱敏。
5. [频率:低][难度:难] 当模型升级或配置变化时，如何保障兼容性与回归测试？ 提示：沙箱环境、回放测试、版本标识。
6. [频率:低][难度:难] 描述守护进程或调度器在 Agent 集群管理中的作用。 提示：心跳检测、任务再分配、故障转移。
7. [频率:低][难度:难] 你会如何在生产中实现自动报警与自愈？ 提示：阈值告警、Playbook、自动重启/熔断。

## 优化与扩展

1. [频率:高][难度:易] 如何通过缓存和记忆复用减少重复调用成本？ 提示：Prompt 缓存、结果缓存、检索复用。
2. [频率:中][难度:易] 对 Agent 策略进行 A/B 测试时需要注意哪些实验设计细节？ 提示：样本划分、对照组、统计显著性。
3. [频率:中][难度:中] 如何利用小模型或规则作为前置过滤以降低大模型调用次数？ 提示：分类器、模板匹配、轻量模型。
4. [频率:中][难度:中] 当需要扩展至多地区部署时，如何处理延迟与法规问题？ 提示：区域路由、数据合规、延迟补偿。
5. [频率:低][难度:中] 描述结合事件驱动架构或消息队列扩展 Agent 的方法。 提示：event bus、消费组、幂等。
6. [频率:低][难度:难] 如何在 Agent 中引入成本治理与预算告警？ 提示：统计每次调用费用、配额、阈值。
7. [频率:低][难度:难] 分享一次你将 Agent 能力嵌入现有企业工作流的经验。 提示：API 网关、权限管理、审批流程。

## 实战案例与复盘

1. [频率:高][难度:中] 讲述一个你设计的多 Agent 协作项目，从需求拆解到上线的全过程。 提示：角色设计、工具选型、验收标准。
2. [频率:中][难度:中] 面对需求快速变化，你如何保证 Agent 配置与代码的可维护性？ 提示：配置中心、版本控制、自动化测试。
3. [频率:中][难度:难] 分享一次因工具调用失败导致事故的案例，你如何改进？ 提示：根因分析、重试策略、监控补强。
4. [频率:中][难度:难] 当业务量激增时，Agent 工作流如何扩容？ 提示：水平扩展、任务分片、异步化。
5. [频率:中][难度:难] 描述引入 Guardrails 后对业务体验的影响与调优过程。 提示：命中率、误杀率、反馈机制。
6. [频率:低][难度:难] 如何与跨职能团队协同完成 Agent 项目交付？ 提示：需求澄清、节奏对齐、里程碑管理。
7. [频率:低][难度:难] 总结一次失败的 Agent 实验，哪些教训值得借鉴？ 提示：目标不清、数据不足、评估缺失。
8. [频率:低][难度:难] 结合业务指标说明 Agent 为团队带来的量化价值。 提示：节省人力、提升 SLA、拓展新功能。
