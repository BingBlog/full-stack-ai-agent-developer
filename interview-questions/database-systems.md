# 数据库系统与缓存架构

## 关系型数据库基础

1. [频率:高][难度:易] 描述第一范式到第三范式的定义与应用场景。 提示：强调字段原子性、部分依赖、传递依赖的消除。
2. [频率:高][难度:易] 解释主键、唯一键、外键的区别，并说明何时选择联合主键。 提示：约束作用、唯一性、参照完整性。
3. [频率:高][难度:中] MySQL InnoDB 与 MyISAM 在存储结构与事务支持上的差异是什么？ 提示：聚簇索引、行锁、崩溃恢复。
4. [频率:中][难度:中] 聚簇索引与非聚簇索引的实现原理有何不同？ 提示：数据页顺序、回表开销、覆盖索引。
5. [频率:中][难度:中] 解释 MVCC（多版本并发控制）在 InnoDB 中的实现。 提示：undo log、Read View、快照读。
6. [频率:中][难度:难] 大表拆分（垂直/水平）的适用场景与风险是什么？ 提示：列分离、范围分片、跨分片事务。
7. [频率:低][难度:难] 描述从 CAP 理论角度看传统关系型数据库具备哪些特性，以及如何在业务中取舍。 提示：强一致性、可用性、分区容错的权衡。

## SQL 查询与性能调优

1. [频率:高][难度:易] 如何使用 `EXPLAIN`/`EXPLAIN ANALYZE` 解读执行计划？ 提示：关注 type、rows、extra。
2. [频率:高][难度:易] 说明索引失效的常见原因（函数操作、前缀模糊、隐式转换）。 提示：条件顺序、类型一致性。
3. [频率:高][难度:中] 当出现慢查询时的一般排查步骤是什么？ 提示：SQL 日志、执行计划、索引调整、重写。
4. [频率:中][难度:中] 解释覆盖索引与回表的区别，并说明如何利用联合索引优化查询。 提示：Extra=Using index、列顺序。
5. [频率:中][难度:中] 如何处理分页查询的性能问题？ 提示：延迟关联、游标分页、缓存。
6. [频率:中][难度:难] 在复杂报表或多表 JOIN 中如何控制驱动表与 Join 顺序？ 提示：小表驱动大表、子查询重写、JOIN Hints。
7. [频率:低][难度:难] 描述基于代价优化器（CBO）的统计信息收集策略。 提示：ANALYZE TABLE、直方图、自动刷新。

## 事务、锁与复制机制

1. [频率:高][难度:易] 解释 ACID 四个特性，并举例说明失败场景。 提示：原子性、隔离性、持久性。
2. [频率:高][难度:易] MySQL 中常见的隔离级别有哪些，对幻读/不可重复读的影响是什么？ 提示：RR、RC、锁视图。
3. [频率:高][难度:中] 列举行锁、表锁、意向锁的差异，并说明锁升级的触发条件。 提示：InnoDB、锁粒度、冲突。
4. [频率:中][难度:中] Binlog、Redo Log、Undo Log 在事务提交流程中分别承担什么角色？ 提示：两阶段提交、崩溃恢复、MVCC。
5. [频率:中][难度:中] 如何剖析死锁日志并制定解决策略？ 提示：等待图、最小化事务、锁顺序。
6. [频率:中][难度:难] 说明主从复制（异步、半同步）的实现方式与延迟治理。 提示：relay log、ACK、GTID。
7. [频率:低][难度:难] 描述分布式事务的 2PC/3PC 机制，并说明为什么需要引入 Saga/补偿方案。 提示：阻塞问题、可靠消息、最终一致性。

## PostgreSQL 深度特性

1. [频率:高][难度:易] PostgreSQL 的 MVCC 与 VACUUM 机制如何协同保持性能？ 提示：多版本、垃圾回收、autovacuum。
2. [频率:高][难度:易] 解释 `EXPLAIN (ANALYZE, BUFFERS)` 输出中值得关注的字段。 提示：实际耗时、共享缓冲命中。
3. [频率:高][难度:中] PostgreSQL 中的多索引类型（B-Tree、GIN、GiST、BRIN）分别适用于什么场景？ 提示：全文检索、范围查询、大数据。
4. [频率:中][难度:中] 如何使用扩展（Extensions）增强 PostgreSQL 能力？ 提示：pg_stat_statements、PostGIS、pgvector。
5. [频率:中][难度:中] 描述逻辑复制与物理复制的差异与适用场景。 提示：wal_level、变更订阅、跨版本升级。
6. [频率:中][难度:难] 解释分区表的实现方式及其对执行计划的影响。 提示：范围/列表分区、约束排除、partition pruning。
7. [频率:低][难度:难] 分享一次使用自定义函数/存储过程（PL/pgSQL）优化业务逻辑的案例。 提示：靠近数据、事务一致性、性能收益。

## Redis 与缓存架构

1. [频率:高][难度:易] Redis 常见数据结构及适用业务场景有哪些？ 提示：String、Hash、List、Set、ZSet、Stream。
2. [频率:高][难度:易] 解释缓存雪崩、穿透、击穿的成因与防护策略。 提示：过期错峰、布隆过滤器、互斥锁。
3. [频率:高][难度:中] Redis 事务（MULTI/EXEC）与 Lua 脚本在保证原子性上的差异是什么？ 提示：命令队列、evalsha。
4. [频率:中][难度:中] 如何选择适合的过期策略（LRU/LFU/TTL）与内存淘汰机制？ 提示：缓存命中率、热点保护。
5. [频率:中][难度:中] Redis Cluster 与哨兵模式在高可用上的差异是什么？ 提示：分片、主从切换、客户端路由。
6. [频率:中][难度:难] 当 Redis 需要持久化时如何在 RDB、AOF、混合模式之间做选择？ 提示：持久性 vs 性能、重写策略。
7. [频率:低][难度:难] 描述一次你定位 Redis 热点 key 或连接数突增问题的过程。 提示：慢日志、监控、限流。

## 分布式与高可用设计

1. [频率:高][难度:易] 主从复制、读写分离架构的常见模式是什么？ 提示：主写从读、延迟一致、故障转移。
2. [频率:高][难度:易] 解释数据分片（Sharding）的关键设计决策。 提示：分片键、路由、跨分片查询。
3. [频率:高][难度:中] 如何设计双写或多源复制时的数据冲突解决策略？ 提示：版本号、时间戳、最终一致。
4. [频率:中][难度:中] 讨论 BASE 理论与最终一致性在实际系统中的应用。 提示：AP 系统、补偿操作、幂等。
5. [频率:中][难度:中] 数据库与缓存一致性如何保证？ 提示：延迟双删、消息队列、TTL。
6. [频率:中][难度:难] 描述一次跨机房/多活架构设计中的挑战与落地过程。 提示：时延、数据同步、冲突避免。
7. [频率:低][难度:难] 分享你对数据库中台或数据服务 API 化的实践经验。 提示：抽象层、治理、灰度。

## 运维监控与项目实践

1. [频率:高][难度:易] 日常需要关注哪些数据库监控指标？ 提示：QPS、慢查询、IO、连接数。
2. [频率:高][难度:易] 如何规划备份策略与灾备演练？ 提示：全量+增量、恢复时间目标、脚本化。
3. [频率:高][难度:中] 解释观察数据库日志（错误日志、慢日志、审计日志）的常用方法。 提示：logrotate、聚合、告警。
4. [频率:中][难度:中] 当遇到表结构变更（DDL）时如何实现不停机发布？ 提示：Online DDL、影子表、gh-ost。
5. [频率:中][难度:中] 描述一次你处理数据库性能劣化或锁等待的排障流程。 提示：采集现场、kill session、回滚。
6. [频率:中][难度:难] 如何在容器/Kubernetes 环境中部署有状态数据库并保障稳定？ 提示：StatefulSet、存储卷、运维工具。
7. [频率:低][难度:难] 解释数据库安全治理的重点，包括权限最小化与数据脱敏。 提示：RBAC、审计、静态/动态脱敏。
8. [频率:低][难度:难] 分享一个你主导的数据库治理或迁移项目，总结关键挑战与收益。 提示：调研、验证、迁移窗口、回滚预案。
